<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">  

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Language" content="en"/>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>rob-ward.co.uk</title>
<meta name="description" content="Rob Ward Homepage"/>
<meta name="keywords" content="Intrepid, linux, opensource"/>

<style type="text/css">
body {
    font-family: monospace;
} 
</style>
</head>

<body>
	<h1>Rob Ward's Blog</h1>
<p>
    <a href="http://validator.w3.org/check?uri=referer"><img
      src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Strict" height="31" width="88" /></a>

    <a href="http://jigsaw.w3.org/css-validator/check/referer">
        <img style="border:0;width:88px;height:31px"
            src="http://jigsaw.w3.org/css-validator/images/vcss"
            alt="Valid CSS!" />
    </a>
</p>
<p>
<object><hr/></object>
</p>


<h2>2014-10-28</h2>
<p>
<code>
So, the first stage for me to build a custom Linux distro is to sort out repos for
the build system and packages I want to build.
<br/><br/>
I previously decided I was going to use github to host this work, at least
initially. As such my plan is to create a single repo to store my build system.
I will also have a separate repo for storing each of the packages I am going to
build, at least I will for any that are not already available in a git repo or
where I need the ability to modify them.
<br/><br/>I generally use the git-repo[0]
tool developed by Google for the android project when I want to manage multiple
git repos. Git-repo works very well and gives you a lot of control, especially
when sharing code between multiple teams.
<br/><br/>
I have however decided that I am going to use git submodules[1] instead, I have
used these in the past and they should do what I need at the moment, I can always
change later easily enough if I need to.
<br/><br/>
So to start with I will be creating a repo that will manage the submodules and
also hold the top level build system and documentation. Below this I will place
all the source that I am building as separate repos.
<br/><br/>
In order to create a repo I need a name and custom-linux-distro just doesn't
quite work for me. As such I have decided, at least for now, to call it
intrepid-Linux.
<br/><br/>
So that is it, I have created the repo[2] and all I have to do is start adding code
and building up a system.
<br/><br/>
Easy right....
<br/><br/>
Well actually the first few stages are quite easy, my first task will be to add
some build commands for the kernel and get it building and running in QEMU. I
will do the first stage with a initramfs only(I will cover what this is later)
and I will add a microscopic statically linked init system into the mix as well
to prevent the kernel rebooting straight away. At this point I will need to
decide on a plan for what I want to achieve first and how...
<br/>
<br/>
[0] - https://code.google.com/p/git-repo/<br/>
[1] - http://git-scm.com/book/en/v2/Git-Tools-Submodules<br/>
[2] - https://github.com/rob-ward/intrepid-linux<br/>
<br/>
</code>
<object><hr/></object>
</p>
	<h2>2014-10-27</h2>
<p>
<code>
Okay folks, after several weeks(months(years???)) of thinking about it I have decided to create my own custom Linux[0] distro.
<br/><br/>
At this point I should probably clarify that this is not the first time that I have made my own custom distro. I work developing embedded Linux devices and as part of this I have developed custom Linux distros or built upon others custom distributions on several occasions. I have also personally built a number of simplified Linux distros in the past, usually for fun and to learn new technologies.
<br/><br/>
So what is different this time??? Well in the past the distros I have developed have all stopped at embedded device level, usable yes, but of limited functionality usually restricted to command line interfaces or running services i.e. web servers. In short, they have all had limited scope. This time I have decided that I want to create something on a larger scale, with nearly unlimited scope. I am not intending what I create to be of use for one specific purpose but rather as a personal playground where I can test and learn new technologies. In no way do I intend to create a Linux distro that you would download and install on your Grandparents PC. Hell, I don't really expect it to be something that anyone that isn't wanting to learn about or hack a Linux system will be even touching!
<br/><br/>
So what is the Plan? Well I suppose my plan is to come up with a plan. I do however have certain points already mapped out. 
<br/><br/>
Firstly I am (best intentions) going to try and keep this blog up to date with the progress that I am making, along with anything useful I learn on the way. I am also planning to do as much in the open as possible.
<br/><br/>
The development will happen using git as my version control system, generally I use Gerrit[1] as my git backend, however at least for now I am indenting to use GitHub[2] to store and share my work in progress. The key plan is to make everything available.
<br/><br/>
The majority of the work, at least to start with is creating a make system that is able to create a bootable Linux+RootFS. To start with this will all be done using GNU Make[3], however I have several ideas that I would like to explore with regards to make systems so I will likely swap and change this at some point.
<br/><br/>
I will initially be using QEMU[4] for development but that can(and will) change. I am also aiming to make the system in such a way that it is able to cross compile. Cross compilation generally adds a lot of complexity, however it highlights issues with packages that you are building very early. It also means you end up fixing broken upstream make systems quite often. I must admit at this point that I am slightly fearful of attempting to get Xorg cross compiling, it was painful enough a few years ago when I compiled it natively... but it is just another challenge to overcome. 
<br/><br/>
The system that I am building will need the ability to build itself so that will be one of the goals. I am also going to be using musl[5] as my c library, the primary reason for this is it looks like a nice project and I haven't used it for anything big as of yet. I will however aim to make the build system so it can support others(uClibc[6] and glibc[7] are the obvious ones but who knows).
<br/><br/>
The other thing I want to get right, and this relates back to potential alternatives to GNU make, is building in parallel as much as possible. When building something like this you should be able to use as many CPU cores as possible, I may even set it up for distcc[8] just for fun.
<br/><br/>
If I progress far enough I will have to start looking at storing parts of the builds as binaries, however that will be a long way down the road.
<br/><br/>
So that is it, the part of a plan that I have. As I figure more out I will update here, along with adding links to any repos with source in that I need.
<br/><br/>

[0] - https://www.kernel.org/<br/>
[1] - https://code.google.com/p/gerrit/ <br/>
[2] - https://github.com/<br/>
[3] - http://www.gnu.org/software/make/<br/>
[4] - http://www.qemu.org<br/>
[5] - http://www.musl-libc.org/<br/>
[6] - http://www.uclibc.org/<br/>
[7] - http://www.gnu.org/software/libc/<br/>
[8] - https://code.google.com/p/distcc/<br/>
<br/>
</code>
<object><hr/></object>
</p>
</body>

</html>
